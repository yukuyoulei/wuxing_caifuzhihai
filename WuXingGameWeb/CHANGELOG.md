# 更新日志

## [1.4.0] - 2025-12-15

### UI 优化

#### 布局改进
- **固定分辨率设计**：游戏界面采用固定最大宽度（1400px），确保在不同屏幕上的一致体验
- **技能系统对话框**：将技能面板移至弹窗中，通过操作面板的"技能系统"按钮打开
- **居中布局**：游戏内容在屏幕中央显示，提供更好的视觉焦点
- **紧凑布局**：移除底部技能面板，使主游戏界面更加简洁

#### 交互优化
- 在操作面板添加"技能系统"按钮，使用 Sparkles 图标
- 技能面板在对话框中显示，支持滚动查看
- 对话框最大宽度 4xl，最大高度 90vh，适配不同屏幕

### Bug 修复
- 修复 `useGame must be used within GameProvider` 错误
- 修复 `Cannot read properties of undefined (reading 'icon')` 错误
- 将所有英文提示信息改为中文

## [1.3.0] - 2025-12-15

### 新增技能系统

#### 新功能
- **技能系统**：为每个五行元素添加可升级的技能
  - 每个元素有两个升级方向：阴属性和阳属性
  - **阴属性技能**：增强克制效果
    - 基础效果：减少对手元素 50%
    - 每级增加 5% 减少效果
    - 需要消耗阴货币升级
  - **阳属性技能**：减免被克制惩罚
    - 基础效果：对手元素增加 200%
    - 每级减少 10% 增加效果
    - 需要消耗阳货币升级
  - 技能等级从 0 级开始，可以无限升级

#### 升级成本
- **元素消耗**：基础 10 个 + 当前等级 × 5 个
- **货币消耗**：基础 3 个 + 当前等级 × 2 个
- 成本随等级提升而增加

#### 战斗机制调整
- 克制效果不再是固定的减半/翻倍
- 克制效果受技能等级影响，可以通过升级技能获得更大优势
- 战斗计算自动应用技能加成

#### UI 改进
- 新增技能面板，展示所有五行技能
- 每个技能卡片显示：
  - 当前阴/阳属性等级
  - 当前效果百分比
  - 升级按钮和成本
- 技能面板位于游戏主界面底部

#### 技术实现
- 新增 `Skill`、`SkillSet`、`SkillUpgradeCost` 类型定义
- 新增技能相关工具函数：
  - `initializeSkills()` - 初始化技能集合
  - `calculateSkillUpgradeCost()` - 计算升级成本
  - `calculateCounterEffect()` - 计算克制效果
  - `applyCounterEffect()` - 应用克制效果到战斗
- 更新 `GameContext` 添加技能状态和 `upgradeSkill` 函数
- 新增 `SkillCard` 和 `SkillPanel` 组件
- 技能数据持久化到 localStorage

#### 文档更新
- 更新游戏指南，添加技能系统详细说明
- 更新快速开始指南，添加技能升级技巧
- 更新操作说明，添加技能升级操作

#### 影响
- 增加游戏深度和策略性
- 玩家可以根据战斗风格培养不同的技能
- 阴阳货币有了新的用途，不仅用于扭转战局
- 长期游戏体验更加丰富，有明确的成长目标

---

## [1.2.0] - 2025-12-15

### 游戏机制重大调整

#### 改变
- **元素消耗机制优化**：实现基于战斗结果的差异化元素消耗
  - **冒险成功**：战斗中使用的元素不会被消耗，全部保留
  - **冒险失败**：失去所有失败回合中使用的元素
  - 增加了风险与收益的平衡，提升策略深度

- **失败处理选项扩展**：
  - 之前：失败后只能使用货币扭转一个回合
  - 现在：可以选择使用货币扭转，或直接返回出生点（不消耗货币）
  - 新增"直接返回出生点"按钮，给玩家更多选择

#### 影响
- 游戏策略深度显著提升
- 成功与失败的差异更加明显，增加紧张感
- 玩家需要更谨慎地选择战斗元素
- 货币使用变得更加灵活，不再是唯一选项
- 元素管理重新变得重要，需要平衡风险

#### 技术实现
- 新增 `handleBattleLose` 函数处理失败时的元素扣除
- 修改 `returnToSpawn` 函数，完整重置战斗状态
- 更新 `BattleArea` 组件，添加"直接返回出生点"按钮
- 优化失败提示信息，显示具体失去的元素

#### 文档更新
- 更新游戏指南，详细说明成功/失败的元素消耗规则
- 更新快速开始指南，调整元素管理和战斗策略建议
- 更新 CHANGELOG，记录所有变更

---

## [1.1.0] - 2025-12-15

### 游戏机制调整

#### 改变
- **战斗元素消耗机制调整**：战斗过程中不再消耗玩家的元素
  - 之前：每次对比后会扣除玩家使用的元素数量
  - 现在：战斗过程中元素数量保持不变，可以重复使用同一种元素
  
#### 影响
- 游戏难度降低，更注重策略选择而非资源管理
- 玩家可以更自由地选择最优元素进行战斗
- 元素补充的重要性降低，只需在游戏开始时补充一次
- 战斗策略更加灵活，可以在多个回合中使用同一种优势元素

#### 文档更新
- 更新游戏指南，说明战斗不消耗元素的机制
- 更新快速开始指南，调整元素管理策略
- 更新实现总结，反映新的游戏机制

---

## [1.0.0] - 2025-12-15

### 初始版本

#### 功能
- ✅ 完整的五行相克战斗系统
- ✅ 随机地图探险机制
- ✅ 阴阳货币系统
- ✅ 本地进度保存
- ✅ 响应式界面设计
- ✅ 传统五行主题配色

#### 游戏机制
- 玩家从 (0,0) 出生点开始
- 随机四个对角方向移动
- 5 回合制战斗系统
- 五行相克规则（金克木、木克土、土克水、水克火、火克金）
- NPC 元素补充功能
- 货币扭转战斗结果功能

#### 技术实现
- React 18 + TypeScript
- shadcn/ui 组件库
- Tailwind CSS 样式
- React Context 状态管理
- localStorage 数据持久化
